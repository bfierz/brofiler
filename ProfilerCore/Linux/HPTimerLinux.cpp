#include "../HPTimer.h"
#include <time.h>
#include "../Thread.h"

namespace Profiler
{
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
int64 GetTime()
{
	return clock();
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
int64 GetFrequency()
{
	return CLOCKS_PER_SEC;
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
int64 GetTimeMilliSeconds()
{
	timespec time;
	clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &time);
	return time.tv_sec * 1000 + time.tv_nsec / 1000000;
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
int64 GetTimeMicroSeconds()
{
	timespec time;
	clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &time);
	return time.tv_sec * 1000000 + time.tv_nsec / 1000;
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void SpinSleep(uint32 microSeconds)
{
	int64 time = GetTimeMicroSeconds() + microSeconds;
	while(GetTimeMicroSeconds() < time)
	{
		ThreadSleep(0);
	}
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
}